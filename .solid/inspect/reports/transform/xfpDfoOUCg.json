{
  "resolvedId": "/home/justin/Documents/chat-web-client/src/components/ChatWindow.tsx",
  "transforms": [
    {
      "name": "__load__",
      "result": "import { createSignal, onMount } from \"solid-js\";\nimport ChatBody, { ListElem, MessageType } from \"./ChatBody\";\nimport ChatFooter from \"./ChatFooter\";\nimport \"./ChatWindow.css\";\nimport { usernames } from '../testdata/data.js';\n\nenum Command {\n  SUBSCRIBE = 0,\n  UNSUBSCRIBE = 1,\n  SEND_MESSAGE = 2\n}\n\ninterface Message {\n  command: Command,\n  channel: string,\n  content: string\n}\n\ninterface Content {\n  username: string,\n  message: string\n}\n\nexport default function ChatWindow() {\n  //TODO: replace userId with correct one when auth done\n  let socket: WebSocket;\n  let containerRef: any;\n  const userId = Math.floor(Math.random() * 25);\n  const username = usernames[userId];\n\n  const [messages, setMessages] = createSignal<Array<ListElem>>([\n    /*   {\n         content: {\n           username: \"Admin\",\n           content: \"This is a message from the admin\",\n         },\n         type: MessageType.ADMIN,\n       },\n       {\n         content: {\n           username: \"Error Bot\",\n           content: \"This is a message from the error bot\",\n         },\n         type: MessageType.ERROR,\n       },\n       {\n         content: {\n           username: \"Eric\",\n           content: \"Hey! How are you?!\",\n         },\n         type: MessageType.RECEIVE,\n       },\n       {\n         content: {\n           username: \"Eric\",\n           content: \"Special Request Message!\",\n         },\n         type: MessageType.SPECIAL_REQUEST,\n       },\n       {\n         content: {\n           username: \"Admin\",\n           content: \"This is another a message from the admin\",\n         },\n         type: MessageType.ADMIN,\n       },*/\n  ]);\n\n  const addMessage = async (message: ListElem) => {\n    setMessages([...messages(), message]);\n    if (messages().length > 10) {\n      const tempMessages = [...messages()];\n      tempMessages.shift();\n      setMessages(tempMessages);\n    }\n  };\n\n  const sendMessage = async (msg: string) => {\n\n    const content: Content = {\n      username: username,\n      message: msg\n    }\n\n    const message: Message = {\n      command: Command.SEND_MESSAGE,\n      channel: \"general\",\n      content: JSON.stringify(content)\n    }\n\n    const jsonData = JSON.stringify(message);\n\n    socket.send(jsonData);\n\n    const messageData: ListElem = {\n      content: {\n        username: content.username,\n        content: content.message\n      },\n      type: MessageType.SEND\n    }\n\n    console.log(\"Sent Message\", jsonData, messageData);\n    addMessage(messageData);\n  };\n\n  onMount(async () => {\n    let WEBSOCKET_URL : string = process.env.WEBSOCKET_URL!;\n    let fullURL : string = `ws://` + WEBSOCKET_URL +`/chat?username=${username}`;\n    console.debug('connecting to ' + fullURL);\n    // Create WebSocket connection.\n    socket = new WebSocket(fullURL);\n\n\n    // Connection opened\n    socket.addEventListener(\"open\", (event) => {\n      const subscribeMessage = {\n        command: Command.SUBSCRIBE,\n        channel: \"general\"\n      }\n\n      const jsonData = JSON.stringify(subscribeMessage);\n\n      socket.send(jsonData);\n\n      const messageData: ListElem = {\n        content: {\n          username: \"client\"!,\n          content: \"...Welcome!...\"\n        },\n        type: MessageType.SPECIAL_REQUEST\n      }\n\n      addMessage(messageData);\n    });\n\n    // Listen for messages\n    socket.onmessage = (event) => {\n      const message: Message = JSON.parse(event.data);\n      const content: Content = JSON.parse(message.content);\n\n      if (content.username == username) {\n        return\n      }\n\n      const messageData: ListElem = {\n        content: {\n          username: content?.username!,\n          content: content?.message!\n        },\n        type: MessageType.RECEIVE\n      }\n\n      console.log(\"Message Received\", messageData)\n\n\n\n      addMessage(messageData);\n    };\n\n    // Listen for Closing issues\n    socket.onclose = function (event) {\n      let msg : string = \"\";\n      let msgType: MessageType = MessageType.SPECIAL_REQUEST;\n\n      let errorMessage = function (arg: string) {\n        msg = arg;\n        msgType = MessageType.ERROR;\n      };\n      switch (event.code) {\n        case 1000:\n          msg = \"Good Bye! Closing...\";\n          break;\n        case 1001:\n          errorMessage(\"connection closed due to server going down...\");\n          break;\n        case 10002:\n          errorMessage(\"connection closed due to protocol error\");\n          break;\n        case 10003:\n          errorMessage(\"connection closed due to incorrect data...\");\n          break;\n        case 1004:\n          errorMessage(\"rejected connection...\");\n          break;\n        case 1005:\n          console.log(\"no status code present\");\n          break;\n        case 1006:\n          errorMessage(\"closed abnormally no close control frame...\");\n          break;\n        case 1007:\n          errorMessage(\"connection closed due to inconsistent message type ...\");\n          break;\n        case 1008:\n          errorMessage(\"connection closed due to policy violated...\");\n          break;\n        case 1009:\n          errorMessage(\"connection closed due to message too large...\");\n          break;\n        case 1010:\n          errorMessage(\"connection closed due to extension not recieved...\");\n          break;\n        case 1011:\n          errorMessage(\"server terminating connection...\");\n          break;\n        case 1015:\n          errorMessage(\"failure to perform TLS handshake...\");\n          break;\n        default:\n          errorMessage(\"unknown error...\");\n          break;\n\n      }\n\n      const messageData: ListElem = {\n        content: {\n          username: \"client\",\n          content: msg,\n        },\n        type: msgType\n      }\n\n      addMessage(messageData);\n    }\n\n  });\n\n\n  return (\n    <div class=\"container\">\n      <div class=\"chat-window\">\n        <ChatBody msgs={messages} containerRef={containerRef} />\n        <ChatFooter sendMessage={sendMessage} />\n      </div>\n    </div>\n  );\n}\n",
      "start": 1683869513827,
      "end": 1683869513827
    },
    {
      "name": "solid",
      "result": "import { template as _$template } from \"solid-js/web\";\nimport { getNextElement as _$getNextElement } from \"solid-js/web\";\nimport { getNextMarker as _$getNextMarker } from \"solid-js/web\";\nimport { insert as _$insert } from \"solid-js/web\";\nimport { createComponent as _$createComponent } from \"solid-js/web\";\nimport { $$component as _$$component } from \"solid-refresh\";\nimport { $$refresh as _$$refresh } from \"solid-refresh\";\nimport { $$registry as _$$registry } from \"solid-refresh\";\nconst _REGISTRY = _$$registry();\nconst _tmpl$ = /*#__PURE__*/_$template(`<div class=\"container\"><div class=\"chat-window\"><!#><!/><!#><!/>`);\nimport { createSignal, onMount } from \"solid-js\";\nimport ChatBody, { MessageType } from \"./ChatBody\";\nimport ChatFooter from \"./ChatFooter\";\nimport \"./ChatWindow.css\";\nimport { usernames } from '../testdata/data.js';\nvar Command = /*#__PURE__*/function (Command) {\n  Command[Command[\"SUBSCRIBE\"] = 0] = \"SUBSCRIBE\";\n  Command[Command[\"UNSUBSCRIBE\"] = 1] = \"UNSUBSCRIBE\";\n  Command[Command[\"SEND_MESSAGE\"] = 2] = \"SEND_MESSAGE\";\n  return Command;\n}(Command || {});\nexport default _$$component(_REGISTRY, \"ChatWindow\", function ChatWindow() {\n  //TODO: replace userId with correct one when auth done\n  let socket;\n  let containerRef;\n  const userId = Math.floor(Math.random() * 25);\n  const username = usernames[userId];\n  const [messages, setMessages] = createSignal([\n    /*   {\n         content: {\n           username: \"Admin\",\n           content: \"This is a message from the admin\",\n         },\n         type: MessageType.ADMIN,\n       },\n       {\n         content: {\n           username: \"Error Bot\",\n           content: \"This is a message from the error bot\",\n         },\n         type: MessageType.ERROR,\n       },\n       {\n         content: {\n           username: \"Eric\",\n           content: \"Hey! How are you?!\",\n         },\n         type: MessageType.RECEIVE,\n       },\n       {\n         content: {\n           username: \"Eric\",\n           content: \"Special Request Message!\",\n         },\n         type: MessageType.SPECIAL_REQUEST,\n       },\n       {\n         content: {\n           username: \"Admin\",\n           content: \"This is another a message from the admin\",\n         },\n         type: MessageType.ADMIN,\n       },*/\n  ]);\n  const addMessage = async message => {\n    setMessages([...messages(), message]);\n    if (messages().length > 10) {\n      const tempMessages = [...messages()];\n      tempMessages.shift();\n      setMessages(tempMessages);\n    }\n  };\n  const sendMessage = async msg => {\n    const content = {\n      username: username,\n      message: msg\n    };\n    const message = {\n      command: Command.SEND_MESSAGE,\n      channel: \"general\",\n      content: JSON.stringify(content)\n    };\n    const jsonData = JSON.stringify(message);\n    socket.send(jsonData);\n    const messageData = {\n      content: {\n        username: content.username,\n        content: content.message\n      },\n      type: MessageType.SEND\n    };\n    console.log(\"Sent Message\", jsonData, messageData);\n    addMessage(messageData);\n  };\n  onMount(async () => {\n    let WEBSOCKET_URL = process.env.WEBSOCKET_URL;\n    let fullURL = `ws://` + WEBSOCKET_URL + `/chat?username=${username}`;\n    console.debug('connecting to ' + fullURL);\n    // Create WebSocket connection.\n    socket = new WebSocket(fullURL);\n\n    // Connection opened\n    socket.addEventListener(\"open\", event => {\n      const subscribeMessage = {\n        command: Command.SUBSCRIBE,\n        channel: \"general\"\n      };\n      const jsonData = JSON.stringify(subscribeMessage);\n      socket.send(jsonData);\n      const messageData = {\n        content: {\n          username: \"client\",\n          content: \"...Welcome!...\"\n        },\n        type: MessageType.SPECIAL_REQUEST\n      };\n      addMessage(messageData);\n    });\n\n    // Listen for messages\n    socket.onmessage = event => {\n      const message = JSON.parse(event.data);\n      const content = JSON.parse(message.content);\n      if (content.username == username) {\n        return;\n      }\n      const messageData = {\n        content: {\n          username: content?.username,\n          content: content?.message\n        },\n        type: MessageType.RECEIVE\n      };\n      console.log(\"Message Received\", messageData);\n      addMessage(messageData);\n    };\n\n    // Listen for Closing issues\n    socket.onclose = function (event) {\n      let msg = \"\";\n      let msgType = MessageType.SPECIAL_REQUEST;\n      let errorMessage = function (arg) {\n        msg = arg;\n        msgType = MessageType.ERROR;\n      };\n      switch (event.code) {\n        case 1000:\n          msg = \"Good Bye! Closing...\";\n          break;\n        case 1001:\n          errorMessage(\"connection closed due to server going down...\");\n          break;\n        case 10002:\n          errorMessage(\"connection closed due to protocol error\");\n          break;\n        case 10003:\n          errorMessage(\"connection closed due to incorrect data...\");\n          break;\n        case 1004:\n          errorMessage(\"rejected connection...\");\n          break;\n        case 1005:\n          console.log(\"no status code present\");\n          break;\n        case 1006:\n          errorMessage(\"closed abnormally no close control frame...\");\n          break;\n        case 1007:\n          errorMessage(\"connection closed due to inconsistent message type ...\");\n          break;\n        case 1008:\n          errorMessage(\"connection closed due to policy violated...\");\n          break;\n        case 1009:\n          errorMessage(\"connection closed due to message too large...\");\n          break;\n        case 1010:\n          errorMessage(\"connection closed due to extension not recieved...\");\n          break;\n        case 1011:\n          errorMessage(\"server terminating connection...\");\n          break;\n        case 1015:\n          errorMessage(\"failure to perform TLS handshake...\");\n          break;\n        default:\n          errorMessage(\"unknown error...\");\n          break;\n      }\n      const messageData = {\n        content: {\n          username: \"client\",\n          content: msg\n        },\n        type: msgType\n      };\n      addMessage(messageData);\n    };\n  });\n  return (() => {\n    const _el$ = _$getNextElement(_tmpl$),\n      _el$2 = _el$.firstChild,\n      _el$3 = _el$2.firstChild,\n      [_el$4, _co$] = _$getNextMarker(_el$3.nextSibling),\n      _el$5 = _el$4.nextSibling,\n      [_el$6, _co$2] = _$getNextMarker(_el$5.nextSibling);\n    _$insert(_el$2, _$createComponent(ChatBody, {\n      msgs: messages,\n      containerRef: containerRef\n    }), _el$4, _co$);\n    _$insert(_el$2, _$createComponent(ChatFooter, {\n      sendMessage: sendMessage\n    }), _el$6, _co$2);\n    return _el$;\n  })();\n}, {\n  location: \"src/components/ChatWindow.tsx:24:15\"\n});\nif (import.meta.hot) {\n  _$$refresh(\"vite\", import.meta.hot, _REGISTRY);\n  import.meta.hot.accept();\n}",
      "start": 1683869513827,
      "end": 1683869513862,
      "order": "pre"
    },
    {
      "name": "vite:import-analysis",
      "result": "import { createHotContext as __vite__createHotContext } from \"/@vite/client\";import.meta.hot = __vite__createHotContext(\"/src/components/ChatWindow.tsx\");import { template as _$template } from \"/node_modules/.vite/deps/solid-js_web.js?v=1564f02c\";\nimport { getNextElement as _$getNextElement } from \"/node_modules/.vite/deps/solid-js_web.js?v=1564f02c\";\nimport { getNextMarker as _$getNextMarker } from \"/node_modules/.vite/deps/solid-js_web.js?v=1564f02c\";\nimport { insert as _$insert } from \"/node_modules/.vite/deps/solid-js_web.js?v=1564f02c\";\nimport { createComponent as _$createComponent } from \"/node_modules/.vite/deps/solid-js_web.js?v=1564f02c\";\nimport { $$component as _$$component } from \"/@solid-refresh\";\nimport { $$refresh as _$$refresh } from \"/@solid-refresh\";\nimport { $$registry as _$$registry } from \"/@solid-refresh\";\nconst _REGISTRY = _$$registry();\nconst _tmpl$ = /*#__PURE__*/_$template(`<div class=\"container\"><div class=\"chat-window\"><!#><!/><!#><!/>`);\nimport { createSignal, onMount } from \"/node_modules/.vite/deps/solid-js.js?v=1564f02c\";\nimport ChatBody, { MessageType } from \"/src/components/ChatBody.tsx\";\nimport ChatFooter from \"/src/components/ChatFooter.tsx\";\nimport \"/src/components/ChatWindow.css\";\nimport { usernames } from '/src/testdata/data.ts';\nvar Command = /*#__PURE__*/function (Command) {\n  Command[Command[\"SUBSCRIBE\"] = 0] = \"SUBSCRIBE\";\n  Command[Command[\"UNSUBSCRIBE\"] = 1] = \"UNSUBSCRIBE\";\n  Command[Command[\"SEND_MESSAGE\"] = 2] = \"SEND_MESSAGE\";\n  return Command;\n}(Command || {});\nexport default _$$component(_REGISTRY, \"ChatWindow\", function ChatWindow() {\n  //TODO: replace userId with correct one when auth done\n  let socket;\n  let containerRef;\n  const userId = Math.floor(Math.random() * 25);\n  const username = usernames[userId];\n  const [messages, setMessages] = createSignal([\n    /*   {\n         content: {\n           username: \"Admin\",\n           content: \"This is a message from the admin\",\n         },\n         type: MessageType.ADMIN,\n       },\n       {\n         content: {\n           username: \"Error Bot\",\n           content: \"This is a message from the error bot\",\n         },\n         type: MessageType.ERROR,\n       },\n       {\n         content: {\n           username: \"Eric\",\n           content: \"Hey! How are you?!\",\n         },\n         type: MessageType.RECEIVE,\n       },\n       {\n         content: {\n           username: \"Eric\",\n           content: \"Special Request Message!\",\n         },\n         type: MessageType.SPECIAL_REQUEST,\n       },\n       {\n         content: {\n           username: \"Admin\",\n           content: \"This is another a message from the admin\",\n         },\n         type: MessageType.ADMIN,\n       },*/\n  ]);\n  const addMessage = async message => {\n    setMessages([...messages(), message]);\n    if (messages().length > 10) {\n      const tempMessages = [...messages()];\n      tempMessages.shift();\n      setMessages(tempMessages);\n    }\n  };\n  const sendMessage = async msg => {\n    const content = {\n      username: username,\n      message: msg\n    };\n    const message = {\n      command: Command.SEND_MESSAGE,\n      channel: \"general\",\n      content: JSON.stringify(content)\n    };\n    const jsonData = JSON.stringify(message);\n    socket.send(jsonData);\n    const messageData = {\n      content: {\n        username: content.username,\n        content: content.message\n      },\n      type: MessageType.SEND\n    };\n    console.log(\"Sent Message\", jsonData, messageData);\n    addMessage(messageData);\n  };\n  onMount(async () => {\n    let WEBSOCKET_URL = process.env.WEBSOCKET_URL;\n    let fullURL = `ws://` + WEBSOCKET_URL + `/chat?username=${username}`;\n    console.debug('connecting to ' + fullURL);\n    // Create WebSocket connection.\n    socket = new WebSocket(fullURL);\n\n    // Connection opened\n    socket.addEventListener(\"open\", event => {\n      const subscribeMessage = {\n        command: Command.SUBSCRIBE,\n        channel: \"general\"\n      };\n      const jsonData = JSON.stringify(subscribeMessage);\n      socket.send(jsonData);\n      const messageData = {\n        content: {\n          username: \"client\",\n          content: \"...Welcome!...\"\n        },\n        type: MessageType.SPECIAL_REQUEST\n      };\n      addMessage(messageData);\n    });\n\n    // Listen for messages\n    socket.onmessage = event => {\n      const message = JSON.parse(event.data);\n      const content = JSON.parse(message.content);\n      if (content.username == username) {\n        return;\n      }\n      const messageData = {\n        content: {\n          username: content?.username,\n          content: content?.message\n        },\n        type: MessageType.RECEIVE\n      };\n      console.log(\"Message Received\", messageData);\n      addMessage(messageData);\n    };\n\n    // Listen for Closing issues\n    socket.onclose = function (event) {\n      let msg = \"\";\n      let msgType = MessageType.SPECIAL_REQUEST;\n      let errorMessage = function (arg) {\n        msg = arg;\n        msgType = MessageType.ERROR;\n      };\n      switch (event.code) {\n        case 1000:\n          msg = \"Good Bye! Closing...\";\n          break;\n        case 1001:\n          errorMessage(\"connection closed due to server going down...\");\n          break;\n        case 10002:\n          errorMessage(\"connection closed due to protocol error\");\n          break;\n        case 10003:\n          errorMessage(\"connection closed due to incorrect data...\");\n          break;\n        case 1004:\n          errorMessage(\"rejected connection...\");\n          break;\n        case 1005:\n          console.log(\"no status code present\");\n          break;\n        case 1006:\n          errorMessage(\"closed abnormally no close control frame...\");\n          break;\n        case 1007:\n          errorMessage(\"connection closed due to inconsistent message type ...\");\n          break;\n        case 1008:\n          errorMessage(\"connection closed due to policy violated...\");\n          break;\n        case 1009:\n          errorMessage(\"connection closed due to message too large...\");\n          break;\n        case 1010:\n          errorMessage(\"connection closed due to extension not recieved...\");\n          break;\n        case 1011:\n          errorMessage(\"server terminating connection...\");\n          break;\n        case 1015:\n          errorMessage(\"failure to perform TLS handshake...\");\n          break;\n        default:\n          errorMessage(\"unknown error...\");\n          break;\n      }\n      const messageData = {\n        content: {\n          username: \"client\",\n          content: msg\n        },\n        type: msgType\n      };\n      addMessage(messageData);\n    };\n  });\n  return (() => {\n    const _el$ = _$getNextElement(_tmpl$),\n      _el$2 = _el$.firstChild,\n      _el$3 = _el$2.firstChild,\n      [_el$4, _co$] = _$getNextMarker(_el$3.nextSibling),\n      _el$5 = _el$4.nextSibling,\n      [_el$6, _co$2] = _$getNextMarker(_el$5.nextSibling);\n    _$insert(_el$2, _$createComponent(ChatBody, {\n      msgs: messages,\n      containerRef: containerRef\n    }), _el$4, _co$);\n    _$insert(_el$2, _$createComponent(ChatFooter, {\n      sendMessage: sendMessage\n    }), _el$6, _co$2);\n    return _el$;\n  })();\n}, {\n  location: \"src/components/ChatWindow.tsx:24:15\"\n});\nif (import.meta.hot) {\n  _$$refresh(\"vite\", import.meta.hot, _REGISTRY);\n  import.meta.hot.accept();\n}",
      "start": 1683869513862,
      "end": 1683869513866,
      "order": "normal"
    }
  ]
}
